---
date: '2022-09-22'
title: 'TIL'
categories: ['TIL']
summary: 'React.Fragment, React Portals, useeffect, useRef, useReducer, contextAPI(useContext)ë¥¼ í•™ìŠµí–ˆìŠµë‹ˆë‹¤.'
thumbnail: './thumbnail/TIL.png'
---

React.Fragment, React Portals, useeffect, useRef, useReducer, contextAPI(useContext)ë¥¼ í•™ìŠµí–ˆìŠµë‹ˆë‹¤. ìš”ë²ˆ ì„¹ì…˜ì€ ê½¤ë‚˜ ê¹Œë‹¤ë¡­ë„¤ìš”. ë¹„êµì  ë‚œì´ë„ê°€ ì˜¬ë¼ê°„ ë“¯í•œ ëŠë‚Œì„ ë°›ì•˜ìŠµë‹ˆë‹¤.

# div tag soup?

div tag soupì´ë€ ì•„ë˜ì™€ ê°™ì€ í˜•íƒœì˜ ëª»ìƒê¸´ í˜•íƒœë¥¼ ëœ»í•©ë‹ˆë‹¤.

```jsx
<div>
  <div>
    <div>
      <p>hellow world!</p>
    </div>
  </div>
</div>
```

JSXëŠ” í•˜ë‚˜ì˜ íƒœê·¸ë§Œ ë¦¬í„´í•´ì•¼ë§Œ í•˜ê³  ì£¼ë¡œ divë¡œ ê°ì‹¸ ë¦¬í„´í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ìœ„ì™€ ê°™ì´ ë¶ˆí•„ìš”í•œ div íƒœê·¸ë“¤ì´ ìƒì„±ë©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?

```jsx
const Wrapper = props => {
  return props.children;
};

export default Wrapper;
```

Wrapper ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ê³  div íƒœê·¸ ëŒ€ì‹  Wrapperë¡œ ê°ì‹¸ë©´ ë¶ˆí•„ìš”í•œ divê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤. ì´ê²ƒì„ ì§ì ‘ Wrapperë¡œ ì„ ì–¸í•˜ì§€ ì•Šì•„ë„ ë¦¬ì—‘íŠ¸ ë‚´ì—ì„œ `<React.Fragment>`ë‚˜ `<>`ì˜ í˜•íƒœë¡œ ì œê³µí•©ë‹ˆë‹¤.

```jsx
// ì‚¬ìš© ì˜ˆ 1
return <React.Fragment>...</React.Fragment>;

// ì‚¬ìš© ì˜ˆ 2
return <>...</>;
```

---

# React Portals

ë¦¬ì—‘íŠ¸ í¬í„¸ì„ ì´ìš©í•˜ë©´ `ë Œë”ë§ ëœ htmlì„ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ì˜®ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.` ì˜ˆë¥¼ ë“¤ì–´, ëª¨ë‹¬ì°½ì´ í‰ì†Œì—ëŠ” ìˆ¨ê²¨ì§€ê³  ì˜ëª»ëœ ê°’ì„ ì…ë ¥í•  ë•Œë§Œ ë Œë”ë§ ëœë‹¤ê³  í–ˆì„ ë•Œ, ì›¹ ì ‘ê·¼ì„±ê³¼ ì˜ë¯¸ë¡ ì ìœ¼ë¡œ ì¢‹ì§€ ëª»í•œ ê²°ê³¼ë¥¼ ë‚³ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ í¬í„¸ì„ ì´ìš©í•˜ì—¬ body íƒœê·¸ì˜ ë°”ë¡œ ë’¤ì— ë„£ëŠ”ê²Œ ì¼ë°˜ì ì…ë‹ˆë‹¤. ì‚¬ìš©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

```html
// public/index.html
<body>
  <div id="backdrop-root"></div>
  <div id="overlay-root"></div>
  <div id="root"></div>
</body>
```

root íƒœê·¸ ìœ„ì— ë‘ê°œì˜ divë¥¼ ì„ ì–¸í•©ë‹ˆë‹¤.

```jsx
// ErrorModal.js

// ReactDOMì„ import í•©ë‹ˆë‹¤.
import ReactDOM from 'react-dom';

// ì›ë˜ í•œêµ°ë°ì— ìˆì—ˆë˜ jsxë¥¼ ë¶„ë¦¬í•©ë‹ˆë‹¤.
const Backdrop = props => {
  return <div className={classes.backdrop} onClick={props.onConfirm} />;
};

const ModalOverlay = props => {
  return (
    <Card className={classes.modal}>
      <header className={classes.header}>
        <h2>{props.title}</h2>
      </header>
      <div className={classes.content}>
        <p>{props.message}</p>
      </div>
      <footer className={classes.actions}>
        <Button onClick={props.onConfirm}>Okay</Button>
      </footer>
    </Card>
  );
};

const ErrorModal = props => {
  return (
    // ë©”ì¸ ë³€ìˆ˜ì—ì„œ í¬í„¸ì„ ì—°ê²°í•´ì¤ë‹ˆë‹¤.
    <React.Fragment>
      {ReactDOM.createPortal(
        <Backdrop onConfirm={props.onConfirm} />,
        document.getElementById('backdrop-root'),
      )}
      {ReactDOM.createPortal(
        <ModalOverlay
          title={props.title}
          message={props.message}
          onConfirm={props.onConfirm}
        />,
        document.getElementById('overlay-root'),
      )}
    </React.Fragment>
  );
};

export default ErrorModal;
```

ì´ëŸ¬í•œ ì‘ì—…ì„ ê±°ì¹˜ë©´ backdrop-rootì™€ overlay-root íƒœê·¸ì— ì•Œë§ì€ ê°’ë“¤ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤.

---

# Ref

propsë¥¼ ìƒí˜¸ì‘ìš© í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì£¼ë¡œ ì• ë‹ˆë©”ì´ì…˜ì„ ì‹¤í–‰ì‹œí‚¬ë•Œë‚˜ í¬ì»¤ìŠ¤, í…ìŠ¤íŠ¸ ì„ íƒì˜ì—­, í˜¹ì€ ë¯¸ë””ì–´ì˜ ì¬ìƒì„ ê´€ë¦¬í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì•„ë˜ëŠ” refë¥¼ ì ìš©í•˜ê¸° ì „, stateì— ì˜í•´ propsë¥¼ ì œì–´í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

```jsx
// addUserë¼ëŠ” ê°’ì„ ì…ë ¥í•˜ëŠ” input ê°’ì´ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ ì…ë‹ˆë‹¤.

const AddUser = props => {
  const [enteredUsername, setEnteredUsername] = useState('');

  const addUserHandler = event => {
    event.preventDefault();
    props.onAddUser(enteredUsername);
    setEnteredUsername('');
  };

  const usernameChangeHandler = event => {
    setEnteredUsername(event.target.value);
  };

  return (
    <input
      id="username"
      type="text"
      value={enteredUsername}
      onChange={usernameChangeHandler}
    />
  );
};

export default AddUser;
```

refë¥¼ ì ìš©í•´ë³´ê² ìŠµë‹ˆë‹¤.

```jsx
import React, { useState, useRef } from 'react';

const AddUser = props => {
  const nameInputRef = useRef(); // ref ì„ ì–¸

  const addUserHandler = event => {
    // refì— ì ‘ê·¼
    const enteredName = nameInputRef.current.value;
    props.onAddUser(enteredName);
    nameInputRef.current.value = '';
  };

  return (
    <input id="username" type="text" ref={nameInputRef} />
    // refë¥¼ ë°”ì¸ë”©
  );
};

export default AddUser;
```

ì£¼ì˜í•  ì ì€ refëŠ” ì œì–´ë˜ì§€ ì•ŠëŠ” ê°’ì´ê³  ë‹¨ì§€ `ì°¸ì¡°í•˜ëŠ” ê°’`ì´ë¼ëŠ” ì ì…ë‹ˆë‹¤.

---

# effect or side effects

## useEffect

ë¦¬ì—‘íŠ¸ëŠ” userì™€ interaction í•˜ê¸°ìœ„í•´ ìƒê²¨ë‚¬ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ê·¸ê²ƒ ë§ê³ ë„ í•´ì•¼ë˜ëŠ” ì¼ë“¤ì´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, HTTPì˜ ìš”ì²­ì„ ì²˜ë¦¬í•œë‹¤ë˜ì§€, ë°±ì•¤ë“œ ì„œë²„ì— ì ‘ê·¼í•œë‹¤ë˜ì§€ í•˜ëŠ” ê²ƒë“¤ ì…ë‹ˆë‹¤. ì´ëŸ°ê²ƒì€ ë¦¬ì—‘íŠ¸ë‚˜ í™”ë©´ì— ê·¸ë¦¬ëŠ” ì¼ê³¼ëŠ” ê´€ë ¨ì´ ì—†ëŠ” ì¼ì…ë‹ˆë‹¤. ì´ëŸ° ì¼ë“¤ì€ ì¼ë°˜ì ì¸ ì»´í¬ë„ŒíŠ¸ ë°–ì—ì„œ ì¼ì–´ë‚˜ì•¼ í•©ë‹ˆë‹¤. ì™œëƒí•˜ë©´ stateëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§ì„ í•˜ê¸° ë•Œë¬¸ì— request ìš”ì²­ì´ ì»´í¬ë„ŒíŠ¸ ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ë©´ ë¬´í•œë£¨í”„ë‚˜ ë²„ê·¸ê°€ ìƒê¸°ê²Œ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ´ë•Œ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ useEffectì…ë‹ˆë‹¤.

`useEffectëŠ” íŠ¹ì • stateë‚˜ propsë¥¼ ë°”ê¿€ ë•Œ ì‚¬ìš©`í•©ë‹ˆë‹¤. ë§Œì•½ ì˜ì¡´ì„±ì´ ì—†ë‹¤ë©´ ì»´í¬ë„ŒíŠ¸ ëœë”ë§ ëœ í›„ ìµœì´ˆ í•œë²ˆë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤.

### Clean up function

```jsx
useEffect(() => {
  console.log('EFFECT RUNNING');

  return () => {
    console.log('EFFECT CLEANUP');
  };
}, [enteredPassword]);
```

return ë¬¸ì´ clean up function ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. ì´ê²ƒì€ ì²˜ìŒ ìµœì´ˆ ì‹¤í–‰ë˜ê¸° ì „ê¹Œì§€ëŠ” ì‹¤í–‰ì´ ë˜ì§€ ì•Šì§€ë§Œ, effectê°€ ì‹¤í–‰ë˜ë©´ `effectì˜ ë‚´ìš©ì´ ì‹œì‘ë˜ê¸°ì „ì— ë¨¼ì € ì‹¤í–‰`ë©ë‹ˆë‹¤.

---

## useReducer

`ë³µì¡í•œ stateë¥¼ ê´€ë¦¬`í•  ë•Œ ìœ ìš©í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ë¥¸ stateë¥¼ ê¸°ë°˜ìœ¼ë¡œ steteë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²½ìš°, í•˜ë‚˜ì˜ stateë¡œ ë³‘í•©í•˜ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤. ë¬¼ë¡  stateë¡œ ì²˜ë¦¬ë¥¼ í•´ì¤˜ë„ ë˜ê³ , useReducerë¥¼ ì‚¬ìš©í•´ë„ ë©ë‹ˆë‹¤. ì•„ë˜ëŠ” reducer ì ìš© ì˜ˆ ì…ë‹ˆë‹¤.

```jsx
import React, { useState, useEffect, useReducer } from 'react';

// ë¦¬ë“€ì„œ ìƒì„±
const emailReducer = (state, action) => {
  if (action.type === 'USER_INPUT') {
    return { value: action.val, isValid: action.val.includes('@') };
  }
  if (action.type === 'USER_BLUR') {
    return { value: state.value, isValid: state.value.includes('@') };
  }
  return { value: '', isValid: false };
};

const Login = props => {
  // ë¦¬ë“€ì„œ ì„ ì–¸
  const [emailState, dispatchEmail] = useReducer(emailReducer, {
    value: '',
    isValid: null,
  });

  const emailChangeHandler = event => {
    dispatchEmail({ type: 'USER_INPUT', val: event.target.value });
  };

  const validateEmailHandler = () => {
    dispatchEmail({ type: 'USER_BLUR' });
  };

  return (
    <input
      type="email"
      id="email"
      value={emailState.value}
      onChange={emailChangeHandler}
      onBlur={validateEmailHandler}
    />
  );
};

export default Login;
```

---

# contextAPI

propsë¥¼ aì—ì„œ dë¡œ ë„˜ê²¨ì¤„ ë•Œ aì—ì„œ bë¥¼ ê±°ì³ cë¥¼ ì§€ë‚˜ì„œ dë¡œ ë„˜ê²¨ì¤˜ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.(aâ†’bâ†’câ†’d) ì´ëŸ° ê²½ìš°, dë§Œ propì´ í•„ìš”í•´ë„ bì™€ cì—ë„ ì„ ì–¸ì„ í•´ì•¼í•©ë‹ˆë‹¤. ì´ëŸ° ê²½ìš°ë¥¼ props chainì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. contextAPIëŠ” `prop chainì„ ë‹¨ì ì„ í•´ì†Œí•˜ê¸° ìœ„í•´ ì‚¬ìš©`í•©ë‹ˆë‹¤. ì•„ë˜ ì½”ë“œëŠ” contextAPIë¥¼ ì ìš©í•œ ì˜ˆì…ë‹ˆë‹¤.

```jsx
//store/auth-context.js
import React from 'react';

const AuthContext = React.createContext({
  isLoggedIn: false,
});

export default AuthContext;
```

AuthContextì— isLoggedInì´ë¼ëŠ” ê°’ì„ ë„£ì–´ì¤ë‹ˆë‹¤. contextë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” provider(ì œê³µì)ì™€ comsumer(ì†Œë¹„ì)ê°€ ìˆìŠµë‹ˆë‹¤. providerì™€ consumerë¥¼ ì„ ì–¸ í•©ë‹ˆë‹¤.

```jsx
// App.js
return (
  <AuthContext.Provider value={{ isLoggedIn }}>
    <MainHeader onLogout={logoutHandler} />
    <main>
      {!isLoggedIn && <Login onLogin={loginHandler} />}
      {isLoggedIn && <Home onLogout={logoutHandler} />}
    </main>
  </AuthContext.Provider>
);
```

```jsx
// Navigation.js
import React from 'react';
import AuthContext from '../store/auth-context';

const Navigation = props => {
  return (
    <AuthContext.Consumer>
      {ctx => {
        return (
          <nav className={classes.nav}>
            <ul>
              {ctx.isLoggedIn && (
                <li>
                  <a href="/">Users</a>
                </li>
              )}
            </ul>
          </nav>
        );
      }}
    </AuthContext.Consumer>
  );
};

export default Navigation;
```

Navigationì•ˆì— ë¦¬í„´ í•œê²ƒì„ Cunsumerë¡œ ë˜ë‹¤ì‹œ ë¦¬í„´.. ë³µì¡í•´ë³´ì´ì£ ? ìš°ì•„í•˜ê²Œ useContextë¥¼ ì´ìš©í•˜ì—¬ ë°”ê¿”ë´…ì‹œë‹¤.

---

## UseContext

```jsx
import React, { useContext } from 'react';
import AuthContext from '../store/auth-context';
import classes from './Navigation.module.css';

const Navigation = props => {
  const ctx = useContext(AuthContext);

  return (
    <nav className={classes.nav}>
      <ul>
        {ctx.isLoggedIn && (
          <li>
            <a href="/">Users</a>
          </li>
        )}
      </ul>
    </nav>
  );
};

export default Navigation;
```

useContextë¥¼ ì´ìš©í•˜ì—¬ í•œê²° ê¹”ë”í•´ì¡ŒìŠµë‹ˆë‹¤!

ì‹¤ì œ í˜„ì—…ì—ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•œë‹¤ê³  í•©ë‹ˆë‹¤.

```jsx
import React, { useState, useEffect } from 'react';

const AuthContext = React.createContext({
  isLoggedIn: false,
  onLogout: () => {},
  onLogin: (email, password) => {},
});

export const AuthContextProvider = props => {
  const [isLoggedIn, setIsLoggedIn] = useState(false);

  useEffect(() => {
    const storedLoggedInInformation = localStorage.getItem('isLoggedIn');
    if (storedLoggedInInformation === '1') {
      setIsLoggedIn(true);
    }
  }, []);

  const logoutHandler = () => {
    localStorage.removeItem('isLoggedIn');
    setIsLoggedIn(false);
  };

  const loginHandler = () => {
    localStorage.setItem('isLoggedIn', '1');
    setIsLoggedIn(true);
  };

  return (
    <AuthContext.Provider
      value={{
        isLoggedIn: isLoggedIn,
        onLogout: logoutHandler,
        onLogin: loginHandler,
      }}
    >
      {props.children}
    </AuthContext.Provider>
  );
};

export default AuthContext;
```

```jsx
// index.js
import React from 'react';
import ReactDOM from 'react-dom/client';
import { AuthContextProvider } from './components/store/auth-context';
import './index.css';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <AuthContextProvider>
    <App />
  </AuthContextProvider>,
);
```

```jsx
// App.js
import Login from './components/Login/Login';
import Home from './components/Home/Home';
import MainHeader from './components/MainHeader/MainHeader';
import React, { useContext } from 'react';
import AuthContext from './components/store/auth-context';

function App() {
  const ctx = useContext(AuthContext);

  return (
    <React.Fragment>
      <MainHeader />
      <main>
        {!ctx.isLoggedIn && <Login />}
        {ctx.isLoggedIn && <Home />}
      </main>
    </React.Fragment>
  );
}

export default App;
```

ì†”ì§íˆ ì—¬ê¸°ê¹Œì§€ëŠ” ì´í•´ë¥¼ ëª»í–ˆìŠµë‹ˆë‹¤. AuthContextì•ˆì—ì„œ ëª¨ë“  ê²ƒì„ ì œì–´í•˜ê³  ìˆëŠ” ì½”ë“œì¸ ê±´ ì•Œê² ëŠ”ë°â€¦ ë³´ê³ ëŠ” ì–¼ì¶” â€˜ì•„ ê·¸ë ‡êµ¬ë‚˜â€™ í•˜ê² ëŠ”ë° í˜¼ì ì§œë³´ì„¸ìš” í•˜ë©´ ëª»í• ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë‹¤ìŒ í”„ë¡œì íŠ¸ í›„ì— ë‹¤ì‹œ í•œë²ˆ ë´ì•¼ ê² ìŠµë‹ˆë‹¤.ğŸ¥²

### contextAPIì˜ í•œê³„ì 

ë³€ê²½ì´ ì¦ì€ ê²½ìš°(1ì´ˆì— ì—¬ëŸ¬ë²ˆ)ì—ëŠ” contextê°€ ì í•©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (ê·¸ëŸ´ë•ŒëŠ” ë¦¬ë•ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤) ë˜í•œ propsì„ ëª¨ë‘ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ”ê±´ ì•„ë‹™ë‹ˆë‹¤. ë”°ë¼ì„œ ìƒí™©ì— ë”°ë¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

---

ë§ˆì§€ë§‰ìœ¼ë¡œ forwardRefì— ê´€í•œ ì˜ˆì‹œë¥¼ ê°•ì‚¬ë‹˜ì´ ë³´ì—¬ì£¼ì…¨ëŠ”ë° ì—­ì‹œë‚˜ ì´í•´ê°€ ì•ˆë˜ë”êµ°ìš”.. ì• ì´ˆì— ì²˜ìŒ ì ‘í•˜ëŠ”ë° ì™„ë²½íˆ ë‹¤ ì•Œê±°ë¼ëŠ” ê¸°ëŒ€ëŠ” í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë‹¤ìŒì— ë‹¤ì‹œ ë³µìŠµí•  ì˜ˆì •ì…ë‹ˆë‹¤.
